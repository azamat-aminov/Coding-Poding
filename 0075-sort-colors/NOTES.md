improve performance by changing algorithm